# syntax=docker/dockerfile:1.4.1

FROM kalilinux/kali-last-release

ARG TOKEI_VERSION=12.1.2

SHELL ["/bin/bash", "-o", "errexit", "-o", "pipefail", "-o", "nounset", "-c"]

RUN <<-EOF
    export DEBIAN_FRONTEND=noninteractive
    apt-get update
    apt-get --yes --no-install-recommends install \
        kali-linux-core \
        kali-tools-top10 \
        \
        ca-certificates \
        curl \
        dnsutils \
        htop \
        inetutils-ftp \
        inetutils-ping \
        inetutils-talk \
        inetutils-telnet \
        inetutils-tools \
        inetutils-traceroute \
        iperf3 \
        iproute2 \
        manpages-dev \
        mtr \
        netcat-openbsd \
        nmap \
        openssh-client \
        openssl \
        subnetcalc \
        tcpdump \
        tshark \
        \
        cloc \
        file \
        tree \
        bat \
        fd-find \
        git \
        htop \
        mc \
        ncdu \
        ripgrep \
        tmux \
        unzip \
        xz-utils \
        \
        gcc \
        git \
        golang \
        ipython \
        lua5.4 \
        make \
        neovim \
        pipx \
        python3 \
        python3-pip
    rm -fr /var/lib/apt/lists/*
EOF

RUN useradd -m user
USER user

RUN umask 077

RUN mkdir -p ~/.local/bin
ENV PATH=/home/user/.local/bin:$PATH

WORKDIR /home/user/workspace
